import{r as o,u as Y,a3 as k,j as e,au as U,J,av as H,af as L,ag as q,D as K,a9 as Z,aj as W,ai as _,d as Q,ak as V,aw as X,ab as P,ax as D}from"./index-e3a33f33.js";const ee=[{id:1,label:"Jan"},{id:2,label:"Feb"},{id:3,label:"Mar"},{id:4,label:"Apr"},{id:5,label:"May"},{id:6,label:"Jun"},{id:7,label:"Jul"},{id:8,label:"Aug"},{id:9,label:"Sep"},{id:10,label:"Oct"},{id:11,label:"Nov"},{id:12,label:"Dec"}],E=s=>{const n=new Date(s),x=ee[n.getMonth()].label,a=n.getDate();return`${x} ${a}`},$=s=>new Date(s).getFullYear(),F=s=>new Date(s).getMonth(),se=s=>{const[n,x]=o.useState("");return o.useEffect(()=>{if(s.checkin&&s.checkout){const a=E(s.checkin),m=E(s.checkout),d=F(s.checkin),N=F(s.checkout),u=$(s.checkin),h=$(s.checkout);if(s.checkin!==s.checkout){if(d!==N&&u===h)return x(`${a} - ${m}, ${u}`);if(u!==h)return x(`${a}, ${u} - ${m}, ${h}`);x(`${a} - ${m}`)}else x(a)}},[s]),n},te=({bookedData:s})=>{console.log({bookedData:s});const[n,x]=o.useState([]),[a,m]=o.useState([]),[d,N]=o.useState(""),[u,h]=o.useState(!1),[g,j]=o.useState(""),[i,y]=o.useState({addressLine1:"",addressLine2:"",city:"",zipcode:""}),[r,v]=o.useState({}),f=Y(t=>{var c;return(c=t.reservations)==null?void 0:c.newReservationsData}),A=k(),z={checkin:s==null?void 0:s.checkIn,checkout:s==null?void 0:s.checkOut},[l,R]=o.useState({firstName:"",lastName:"",email:""}),b=t=>{const c=r;c[`${t}`]&&delete c[`${t}`],v(c)},S=t=>{const{name:c,value:p}=t.target;R({...l,[c]:p}),b(c)},I=se(z),T=f?f.guestNumber:(s==null?void 0:s.adults)+(s==null?void 0:s.children),M=async()=>{try{const t="https://countriesnow.space/api/v0.1/countries/capital",c=await L.get(t);x(c.data.data)}catch(t){console.error("Error fetching countries:",t)}};o.useEffect(()=>{M()},[]);const B=async t=>{if(t){h(!0);try{const c="https://countriesnow.space/api/v0.1/countries/states",p=await L.post(c,{country:t});m(p.data.data.states)}catch(c){console.error("Error fetching states:",c)}finally{h(!1)}}else m([])},w=t=>{const{name:c,value:p}=t.target;y({...i,[c]:p}),b(c)},O=()=>{const t={};return l.firstName||(t.firstName="First Name is required."),l.lastName||(t.lastName="Last Name is required."),l.email||(t.email="Email is required."),i.addressLine1||(t.addressLine1="Address Line 1 is required."),d||(t.country="Country is required."),g||(t.state="State is required."),i.city||(t.city="City is required."),i.zipcode||(t.zipcode="Zip code is required."),v(t),Object.keys(t).length===0},G=async()=>{try{const t=`${q}bookings/`,c={checkIn:s==null?void 0:s.checkIn,checkOut:s==null?void 0:s.checkOut,hotelType:s==null?void 0:s.roomTypeId,rooms:s==null?void 0:s.rooms,adults:s==null?void 0:s.adults,children:s==null?void 0:s.children,guestInformation:{firstName:l==null?void 0:l.firstName,lastName:l==null?void 0:l.lastName,email:l==null?void 0:l.email},address:{addressLine1:i==null?void 0:i.addressLine1,addressLine2:i==null?void 0:i.addressLine2,country:d,state:g,city:i==null?void 0:i.city,zipCode:i==null?void 0:i.zipcode}},p=await L.post(t,c);console.log("BOOKING RESPONSE",{response:p}),K.success("Booking is Successful Please check your email !!"),A("/")}catch(t){console.error("Error BOOKING RESPONSE",t)}},C=async t=>{t.preventDefault(),O()&&G()};return console.log({states:a}),e.jsxs("div",{children:[e.jsxs("div",{className:" flex flex-col gap-6",children:[e.jsx("h5",{className:"text-xl text-[#222222] font-bold",children:"Your Booking Details"}),e.jsxs("div",{className:" flex flex-row justify-between",children:[e.jsxs("span",{className:"text-lg text-[#222222]",children:[e.jsx("p",{className:"font-medium",children:"Dates"}),e.jsx("p",{className:"text-base",children:I})]}),e.jsxs("span",{className:"text-lg text-[#222222]",children:[e.jsx("p",{className:"font-medium",children:"Guests"}),e.jsx("p",{className:"text-center text-base",children:T})]})]}),e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx("h5",{className:"text-lg text-[#222222] font-medium",children:"Guest Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 rounded-md",children:[e.jsx("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700",children:"First Name"}),e.jsx("input",{type:"text",id:"firstName",name:"firstName",value:l.firstName,onChange:S,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2",required:!0}),r.firstName&&e.jsx("p",{className:"text-red-500 text-sm",children:r.firstName})]}),e.jsxs("div",{className:"p-3 rounded-md",children:[e.jsx("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700",children:"Last Name"}),e.jsx("input",{type:"text",id:"lastName",name:"lastName",value:l.lastName,onChange:S,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2",required:!0}),r.lastName&&e.jsx("p",{className:"text-red-500 text-sm",children:r.lastName})]}),e.jsxs("div",{className:"p-3 rounded-md",children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email Address"}),e.jsx("input",{type:"email",id:"email",name:"email",value:l.email,onChange:S,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2",required:!0}),r.email&&e.jsx("p",{className:"text-red-500 text-sm",children:r.email})]})]})]})]}),e.jsx("hr",{className:"w-full h-[1.3px] bg-[#dddddd] my-4"}),e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx("h5",{className:"text-lg text-[#222222] font-medium",children:"Address Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-1 rounded-md",children:[e.jsx("label",{htmlFor:"addressLine1",className:"block text-sm font-medium text-gray-700",children:"Address Line 1"}),e.jsx("input",{type:"text",id:"addressLine1",name:"addressLine1",value:i.addressLine1,onChange:w,className:`mt-1 block w-full border ${r.addressLine1?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2`,required:!0}),r.addressLine1&&e.jsx("p",{className:"text-red-500 text-sm",children:r.addressLine1})]}),e.jsxs("div",{className:"p-1 rounded-md",children:[e.jsx("label",{htmlFor:"addressLine2",className:"block text-sm font-medium text-gray-700",children:"Address Line 2"}),e.jsx("input",{type:"text",id:"addressLine2",name:"addressLine2",value:i.addressLine2,onChange:w,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2"}),r.addressLine1&&e.jsx("p",{className:"text-red-500 text-sm",children:r.addressLine2})]}),e.jsxs("div",{className:"p-1 rounded-md",children:[e.jsx("label",{htmlFor:"country",className:"block text-sm font-medium text-gray-700",children:"Country"}),e.jsxs("select",{id:"country",name:"country",value:d,onChange:t=>{b(t.target.name),N(t.target.value),B(t.target.value),j("")},className:`mt-1 block w-full border ${r.country?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2`,required:!0,children:[e.jsx("option",{value:"",children:"Select Country"}),n.map(t=>e.jsx("option",{value:t.code,children:t.name},t.code))]}),r.country&&e.jsx("p",{className:"text-red-500 text-sm",children:r.country})]}),e.jsxs("div",{className:"p-1 rounded-md",children:[e.jsx("label",{htmlFor:"state",className:"block text-sm font-medium text-gray-700",children:"State"}),e.jsxs("select",{id:"state",name:"state",value:g,onChange:t=>{b(t.target.name),j(t.target.value)},className:`mt-1 block w-full border ${r.state?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2`,required:!0,children:[e.jsx("option",{value:"",children:"Select State"}),u?e.jsx("div",{className:"loader-container",children:e.jsx(U,{color:"#36D7B7",size:10})}):e.jsx(e.Fragment,{children:a.map(t=>e.jsx("option",{value:t.code,children:t.name},t.code))})]}),r.state&&e.jsx("p",{className:"text-red-500 text-sm",children:r.state})]}),e.jsxs("div",{className:"p-1 rounded-md",children:[e.jsx("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700",children:"City"}),e.jsx("input",{type:"text",id:"city",name:"city",value:i.city,onChange:w,className:`mt-1 block w-full border ${r.city?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2`,required:!0}),r.city&&e.jsx("p",{className:"text-red-500 text-sm",children:r.city})]}),e.jsxs("div",{className:"p-1 rounded-md",children:[e.jsx("label",{htmlFor:"zipcode",className:"block text-sm font-medium text-gray-700",children:"Zip Code"}),e.jsx("input",{type:"text",id:"zipcode",name:"zipcode",value:i.zipcode,onChange:w,className:`mt-1 block w-full border ${r.zipcode?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2`,required:!0}),r.zipcode&&e.jsx("p",{className:"text-red-500 text-sm",children:r.zipcode})]})]})]}),e.jsxs("form",{onSubmit:C,children:[e.jsx("hr",{className:"w-full h-[1.3px] bg-[#dddddd] my-10"}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-xl md:text-[22px] text-[#222222] font-medium",children:"Ground rules"}),e.jsx("p",{className:"text-sm md:text-base text-[#222222] py-4",children:"We ask every guest to remember a few simple things about what makes a great guest."}),e.jsxs("ul",{className:"text-sm md:text-base list-disc pl-5",children:[e.jsx("li",{children:"Follow the house rules "}),e.jsx("li",{children:"Treat your Hostâ€™s home like your own"})]})]}),e.jsx("hr",{className:"w-full h-[1.3px] bg-[#dddddd] my-10"}),e.jsx("p",{className:"text-xs opacity-70",children:"By selecting the button below, I agree to the Host's House Rules, Ground rules for guests, Motel's Rebooking and Refund Policy, and that Motel can charge my payment method if Iâ€™m responsible for damage."}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:C,className:`px-4 mt-5 bg-blue-500 text-white p-2 rounded-md transition-opacity ${Object.keys(r).length>0?"bg-gray-400 opacity-50 cursor-not-allowed":"cursor-pointer"} rounded-md py-2`,disabled:Object.keys(r).length>0,children:[e.jsx(J,{icon:H,className:"mr-2"}),"Book"]})})]})]})},re=({listingData:s,calculatedPriceDetails:n})=>{var x;return e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"border border-[#dddddd] rounded-xl p-6 sticky top-24 max-h-[85vh] bg-white overflow-y-auto",children:[e.jsx("div",{className:"grid grid-cols-3 gap-2",children:s==null?void 0:s.photos.slice(0,3).map((a,m)=>e.jsx("div",{children:e.jsx("img",{src:a,alt:`Listing image ${m+1}`,className:"rounded-md object-cover w-full h-[100px] sm:h-[120px]"})},m))}),e.jsxs("div",{className:"grid grid-cols-2 p-4 gap-2",children:[e.jsx("p",{className:"text-sm text-[#222222]",children:s==null?void 0:s.name}),e.jsxs("span",{className:"text-xs text-[#222222] flex justify-end items-center gap-1",children:[e.jsx(Z,{size:16}),((x=s==null?void 0:s.hotel)==null?void 0:x.rating)||"New"]})]}),e.jsx("hr",{className:"w-full h-[1.3px] bg-[#dddddd] mb-6"}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx("h5",{className:"text-[22px] text-[#222222] font-medium pb-1",children:"Your total"}),e.jsxs("div",{className:"grid grid-cols-2 justify-between text-base text-[#222]",children:[e.jsx("p",{children:"1 Night"}),e.jsxs("p",{children:["$",n==null?void 0:n.pricePerNight]})]}),e.jsxs("div",{className:"grid grid-cols-2 justify-between text-base text-[#222]",children:[e.jsxs("p",{children:[n==null?void 0:n.nights," nights"]}),e.jsxs("p",{children:["$",n==null?void 0:n.totalPriceBeforeTax]})]}),e.jsxs("div",{className:"grid grid-cols-2 justify-between text-base text-[#222]",children:[e.jsx("p",{children:"Tax"}),e.jsxs("p",{children:["$",n==null?void 0:n.taxAmount," (",n==null?void 0:n.taxRate,")"]})]})]}),e.jsx("hr",{className:"w-full h-[1.3px] bg-[#dddddd] my-6"}),e.jsxs("div",{className:"grid grid-cols-2 justify-between text-base text-[#222] font-medium",children:[e.jsx("p",{children:"Total (USD)"}),e.jsxs("p",{children:["$",(n==null?void 0:n.totalPriceAfterTax)||"-"]})]})]})})},de=()=>{const[s,n]=o.useState({}),[x,a]=o.useState(!0),m=W();console.log({location:m});const{data:d}=m==null?void 0:m.state,N=k(),u=_(),h=u==null?void 0:u.id,g=Q();o.useEffect(()=>{(async()=>(a(!0),await g(V(h)),a(!1)))()},[h,g,a]),o.useEffect(()=>{},[]),o.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[]);const j=async()=>{var i,y;try{const r={checkIn:d==null?void 0:d.checkIn,checkOut:d==null?void 0:d.checkOut,hotelType:d==null?void 0:d.roomTypeId,rooms:d==null?void 0:d.rooms},v=`${q}bookings/calculate-total-price`,f=await L.post(v,r);n((f==null?void 0:f.data)||{})}catch(r){D.error(((y=(i=r==null?void 0:r.response)==null?void 0:i.data)==null?void 0:y.message)||"Error calculating final price !"),console.error("Error GET FINAL PRICE RESPONSE",r)}};return o.useEffect(()=>{j()},[d]),x?e.jsx("div",{className:" flex justify-center items-center w-full h-[60dvh]",children:e.jsx(X,{color:"#000"})}):e.jsxs("main",{className:" max-w-screen-2xl xl:px-12 mx-auto py-7 xl:py-20",children:[e.jsxs("div",{className:" flex flex-row gap-3 items-center px-3 md:px-5",children:[e.jsx("div",{onClick:()=>{N(-1)},className:" p-2 rounded-full hover:bg-[#f1f1f1] cursor-pointer transition duration-200 ease-in",children:e.jsx(P,{size:28})}),e.jsx("h2",{className:"text-lg sm:text-xl md:text-[32px] text-[#222222] font-medium text-center",children:"Confirm and pay"})]}),e.jsxs("section",{className:" grid grid-cols-1 md:grid-cols-2 gap-10 md:gap-20 pt-10 px-8 md:px-10",children:[e.jsx("div",{className:"order-2 md:order-1",children:e.jsx(te,{bookedData:d})}),e.jsx("div",{className:"order-1 md:order-2",children:e.jsx(re,{calculatedPriceDetails:s,listingData:d==null?void 0:d.listingData})})]})]})};export{de as default};
